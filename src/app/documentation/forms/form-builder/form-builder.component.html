<div class="doc-container">
  <nav class="breadcrumb">
    <a routerLink="/home">üè† Accueil</a>
    <span class="separator">‚Ä∫</span>
    <a routerLink="/documentation">üìö Documentation</a>
    <span class="separator">‚Ä∫</span>
    <span class="current">FormBuilder</span>
  </nav>

  <header class="doc-header">
    <h1>üèóÔ∏è FormBuilder & FormGroup</h1>
    <p class="lead">Service pour cr√©er des formulaires r√©actifs de mani√®re concise et lisible</p>
  </header>

  <section class="doc-section">
    <h2>Qu'est-ce que FormBuilder ?</h2>
    <p>
      <strong>FormBuilder</strong> est un service Angular qui fournit des m√©thodes pratiques pour cr√©er des instances de FormControl, FormGroup et FormArray. Il r√©duit consid√©rablement le code boilerplate n√©cessaire pour cr√©er des formulaires complexes.
    </p>

    <div class="comparison-grid">
      <div class="comparison-card">
        <h3>‚ùå Sans FormBuilder</h3>
        <div class="code-block">
          <pre><code>userForm = new FormGroup({{ '{' }}
  firstName: new FormControl('', Validators.required),
  lastName: new FormControl('', Validators.required),
  email: new FormControl('', [
    Validators.required,
    Validators.email
  ])
{{ '}' }});</code></pre>
        </div>
      </div>

      <div class="comparison-card">
        <h3>‚úÖ Avec FormBuilder</h3>
        <div class="code-block">
          <pre><code>private fb = inject(FormBuilder);

userForm = this.fb.group({{ '{' }}
  firstName: ['', Validators.required],
  lastName: ['', Validators.required],
  email: ['', [Validators.required, Validators.email]]
{{ '}' }});</code></pre>
        </div>
      </div>
    </div>
  </section>

  <section class="doc-section">
    <h2>Injection du Service</h2>
    <div class="code-block">
      <pre><code>import {{ '{' }} FormBuilder {{ '}' }} from '&#64;angular/forms';
import {{ '{' }} inject {{ '}' }} from '&#64;angular/core';

export class MyComponent {{ '{' }}
  // M√©thode moderne (inject function)
  private fb = inject(FormBuilder);

  // OU m√©thode classique (constructor injection)
  constructor(private fb: FormBuilder) {{ '{' }}{{ '}' }}
{{ '}' }}</code></pre>
    </div>
  </section>

  <section class="doc-section">
    <h2>M√©thodes Principales</h2>
    <div class="card-grid">
      @for (method of methods; track method.name) {
        <div class="feature-card">
          <h3>{{ method.name }}</h3>
          <p>{{ method.description }}</p>
        </div>
      }
    </div>
  </section>

  <section class="doc-section">
    <h2>FormGroups Imbriqu√©s</h2>
    <p>FormBuilder facilite la cr√©ation de structures de formulaires complexes avec des groupes imbriqu√©s :</p>
    
    <div class="code-block">
      <pre><code>userForm = this.fb.group({{ '{' }}
  personalInfo: this.fb.group({{ '{' }}
    firstName: ['', Validators.required],
    lastName: ['', Validators.required],
    birthDate: ['']
  {{ '}' }}),
  contactInfo: this.fb.group({{ '{' }}
    email: ['', [Validators.required, Validators.email]],
    phone: ['', Validators.pattern(/^[0-9]{{ '{' }}10{{ '}' }}$/)]
  {{ '}' }}),
  address: this.fb.group({{ '{' }}
    street: [''],
    city: [''],
    zipCode: ['', Validators.pattern(/^[0-9]{{ '{' }}5{{ '}' }}$/)]
  {{ '}' }})
{{ '}' }});</code></pre>
    </div>

    <div class="demo-box">
      <h3>üéÆ Formulaire Imbriqu√©</h3>
      <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
        <fieldset formGroupName="personalInfo">
          <legend>Informations Personnelles</legend>
          <div class="form-group">
            <label>Pr√©nom</label>
            <input formControlName="firstName">
          </div>
          <div class="form-group">
            <label>Nom</label>
            <input formControlName="lastName">
          </div>
          <div class="form-group">
            <label>Date de naissance</label>
            <input type="date" formControlName="birthDate">
          </div>
        </fieldset>

        <fieldset formGroupName="contactInfo">
          <legend>Contact</legend>
          <div class="form-group">
            <label>Email</label>
            <input type="email" formControlName="email">
          </div>
          <div class="form-group">
            <label>T√©l√©phone</label>
            <input formControlName="phone" placeholder="0612345678">
          </div>
        </fieldset>

        <fieldset formGroupName="address">
          <legend>Adresse</legend>
          <div class="form-group">
            <label>Rue</label>
            <input formControlName="street">
          </div>
          <div class="form-group">
            <label>Ville</label>
            <input formControlName="city">
          </div>
          <div class="form-group">
            <label>Code postal</label>
            <input formControlName="zipCode" placeholder="75001">
          </div>
        </fieldset>

        <button type="submit" [disabled]="userForm.invalid">Soumettre</button>
      </form>

      <div class="form-value">
        <h4>Valeur du formulaire :</h4>
        <pre>{{ userForm.value | json }}</pre>
      </div>
    </div>
  </section>

  <section class="doc-section">
    <h2>Acc√©der aux Contr√¥les Imbriqu√©s</h2>
    <div class="code-block">
      <pre><code>// M√©thode 1 : get() avec chemin
const firstName = this.userForm.get('personalInfo.firstName');

// M√©thode 2 : Cha√Æner get()
const email = this.userForm.get('contactInfo')?.get('email');

// M√©thode 3 : Getters pour r√©utilisation
get personalInfo() {{ '{' }}
  return this.userForm.get('personalInfo') as FormGroup;
{{ '}' }}

get contactInfo() {{ '{' }}
  return this.userForm.get('contactInfo') as FormGroup;
{{ '}' }}</code></pre>
    </div>
  </section>

  <section class="doc-section">
    <h2>FormBuilder NonNullable (Angular 14+)</h2>
    <p>FormBuilder peut garantir des valeurs non-null pour √©viter les undefined :</p>
    
    <div class="code-block">
      <pre><code>// FormBuilder standard (peut retourner null)
profileForm = this.fb.group({{ '{' }}
  name: ['']  // Type: string | null
{{ '}' }});

// FormBuilder nonNullable
profileForm = this.fb.nonNullable.group({{ '{' }}
  name: ['']  // Type: string (jamais null)
{{ '}' }});

// Avantage : TypeScript sait que la valeur ne sera jamais null
const name: string = this.profileForm.value.name;  // ‚úÖ OK avec nonNullable</code></pre>
    </div>
  </section>

  <section class="doc-section">
    <h2>Bonnes Pratiques</h2>
    <div class="practices-container">
      <div class="practice-card good">
        <h3>‚úÖ √Ä Faire</h3>
        <ul>
          <li>Utiliser inject() pour l'injection (Angular moderne)</li>
          <li>Cr√©er des getters pour les FormGroups fr√©quemment acc√©d√©s</li>
          <li>Utiliser nonNullable pour √©viter les null checks</li>
          <li>Organiser les formulaires complexes en groupes logiques</li>
          <li>Typer les FormGroups avec des interfaces</li>
        </ul>
      </div>

      <div class="practice-card bad">
        <h3>‚ùå √Ä √âviter</h3>
        <ul>
          <li>Cr√©er des FormGroups trop profond√©ment imbriqu√©s (> 3 niveaux)</li>
          <li>Acc√©der aux contr√¥les avec des cha√Ænes magiques partout</li>
          <li>Oublier de typer les FormGroups</li>
          <li>M√©langer FormBuilder et constructeurs manuels</li>
        </ul>
      </div>
    </div>
  </section>

  <section class="doc-section">
    <h2>Ressources</h2>
    <div class="resources-list">
      <a href="https://angular.dev/api/forms/FormBuilder" target="_blank" class="resource-link">
        üìñ API Reference - FormBuilder
      </a>
      <a href="https://angular.dev/guide/forms/reactive-forms" target="_blank" class="resource-link">
        üìñ Guide - Reactive Forms
      </a>
    </div>
  </section>

  <nav class="doc-navigation">
    <a routerLink="/documentation/forms/reactive-forms" class="nav-button prev">‚Üê Reactive Forms</a>
    <a routerLink="/documentation/forms/validation" class="nav-button next">Validation ‚Üí</a>
  </nav>
</div>
