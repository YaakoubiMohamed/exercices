<div class="doc-container">
  <nav class="breadcrumb">
    <a routerLink="/home">üè† Accueil</a>
    <span class="separator">‚Ä∫</span>
    <a routerLink="/documentation">üìö Documentation</a>
    <span class="separator">‚Ä∫</span>
    <span class="current">ViewChild & ContentChild</span>
  </nav>

  <article class="doc-content">
    <header class="doc-header">
      <h1>üîç ViewChild & ContentChild</h1>
      <p class="doc-subtitle">Acc√©der aux √©l√©ments enfants et au contenu projet√©</p>
    </header>

    <section class="doc-section">
      <h2>üìã Query Decorators</h2>
      <div class="definition-box">
        <p>Les d√©corateurs de requ√™te permettent d'acc√©der aux √©l√©ments du DOM, composants enfants, et contenu projet√© depuis le code TypeScript. Ils sont essentiels pour la manipulation avanc√©e des vues.</p>
      </div>
    </section>

    <section class="doc-section">
      <h2>üéØ Les 4 Query Decorators</h2>
      <div class="decorators-grid">
        @for (decorator of decorators; track decorator.name) {
          <div class="decorator-card">
            <h3>{{ decorator.name }}</h3>
            <div class="decorator-meta">
              <span class="scope-badge">{{ decorator.scope }}</span>
              <span class="timing-badge">{{ decorator.timing }}</span>
            </div>
            <p class="description">{{ decorator.description }}</p>
            <div class="usecase">
              <strong>Use Case:</strong> {{ decorator.useCase }}
            </div>
          </div>
        }
      </div>
    </section>

    <section class="doc-section">
      <h2>üëÅÔ∏è @ViewChild - Acc√®s √† un √âl√©ment</h2>
      <div class="code-section">
        <h3>Acc√©der √† un √âl√©ment DOM</h3>
        <pre><code>import {{ '{' }} Component, ViewChild, ElementRef, AfterViewInit {{ '}' }} from '@angular/core';

@Component({{ '{' }}
  selector: 'app-my-component',
  template: `
    &lt;input #nameInput type="text"&gt;
    &lt;button (click)="focusInput()"&gt;Focus&lt;/button&gt;
  `
{{ '}' }})
export class MyComponent implements AfterViewInit {{ '{' }}
  &#64;ViewChild('nameInput') inputElement!: ElementRef&lt;HTMLInputElement&gt;;
  
  ngAfterViewInit() {{ '{' }}
    // Vue initialis√©e, √©l√©ment accessible
    console.log(this.inputElement.nativeElement.value);
  {{ '}' }}
  
  focusInput() {{ '{' }}
    this.inputElement.nativeElement.focus();
  {{ '}' }}
{{ '}' }}</code></pre>

        <h3>Acc√©der √† un Composant Enfant</h3>
        <pre><code>import {{ '{' }} Component, ViewChild, AfterViewInit {{ '}' }} from '@angular/core';
import {{ '{' }} ChildComponent {{ '}' }} from './child.component';

@Component({{ '{' }}
  selector: 'app-parent',
  template: `
    &lt;app-child&gt;&lt;/app-child&gt;
    &lt;button (click)="callChildMethod()"&gt;Call Child&lt;/button&gt;
  `
{{ '}' }})
export class ParentComponent implements AfterViewInit {{ '{' }}
  &#64;ViewChild(ChildComponent) childComponent!: ChildComponent;
  
  ngAfterViewInit() {{ '{' }}
    // Acc√®s aux propri√©t√©s/m√©thodes du composant enfant
    console.log(this.childComponent.data);
  {{ '}' }}
  
  callChildMethod() {{ '{' }}
    this.childComponent.doSomething();
  {{ '}' }}
{{ '}' }}</code></pre>
      </div>
    </section>

    <section class="doc-section">
      <h2>üëÅÔ∏èüëÅÔ∏è @ViewChildren - Acc√®s √† Plusieurs √âl√©ments</h2>
      <div class="code-section">
        <pre><code>import {{ '{' }} Component, ViewChildren, QueryList, AfterViewInit {{ '}' }} from '@angular/core';
import {{ '{' }} ItemComponent {{ '}' }} from './item.component';

@Component({{ '{' }}
  selector: 'app-list',
  template: `
    &#64;for (item of items; track item.id) {{ '{' }}
      &lt;app-item [data]="item"&gt;&lt;/app-item&gt;
    {{ '}' }}
  `
{{ '}' }})
export class ListComponent implements AfterViewInit {{ '{' }}
  items = [{{ '{' }}id: 1{{ '}' }}, {{ '{' }}id: 2{{ '}' }}, {{ '{' }}id: 3{{ '}' }}];
  
  &#64;ViewChildren(ItemComponent) itemComponents!: QueryList&lt;ItemComponent&gt;;
  
  ngAfterViewInit() {{ '{' }}
    // It√©rer sur tous les composants
    this.itemComponents.forEach(item => {{ '{' }}
      console.log(item.data);
    {{ '}' }});
    
    // Acc√©der au premier/dernier
    const first = this.itemComponents.first;
    const last = this.itemComponents.last;
    
    // √âcouter les changements
    this.itemComponents.changes.subscribe(list => {{ '{' }}
      console.log('List changed:', list.length);
    {{ '}' }});
  {{ '}' }}
{{ '}' }}</code></pre>
      </div>
    </section>

    <section class="doc-section">
      <h2>üì¶ @ContentChild - Acc√®s au Contenu Projet√©</h2>
      <div class="code-section">
        <pre><code>import {{ '{' }} Component, ContentChild, AfterContentInit, ElementRef {{ '}' }} from '@angular/core';

@Component({{ '{' }}
  selector: 'app-card',
  template: `
    &lt;div class="card"&gt;
      &lt;ng-content&gt;&lt;/ng-content&gt;
    &lt;/div&gt;
  `
{{ '}' }})
export class CardComponent implements AfterContentInit {{ '{' }}
  &#64;ContentChild('cardTitle') titleElement!: ElementRef;
  
  ngAfterContentInit() {{ '{' }}
    // Contenu projet√© initialis√©
    if (this.titleElement) {{ '{' }}
      console.log('Title:', this.titleElement.nativeElement.textContent);
    {{ '}' }}
  {{ '}' }}
{{ '}' }}

// Usage
&lt;app-card&gt;
  &lt;h2 #cardTitle&gt;Mon Titre&lt;/h2&gt;
  &lt;p&gt;Contenu de la card&lt;/p&gt;
&lt;/app-card&gt;</code></pre>
      </div>
    </section>

    <section class="doc-section">
      <h2>üì¶üì¶ @ContentChildren - Plusieurs Contenus Projet√©s</h2>
      <div class="code-section">
        <pre><code>import {{ '{' }} Component, ContentChildren, QueryList, AfterContentInit {{ '}' }} from '@angular/core';
import {{ '{' }} TabComponent {{ '}' }} from './tab.component';

@Component({{ '{' }}
  selector: 'app-tabs',
  template: `
    &lt;div class="tabs"&gt;
      &lt;ng-content&gt;&lt;/ng-content&gt;
    &lt;/div&gt;
  `
{{ '}' }})
export class TabsComponent implements AfterContentInit {{ '{' }}
  &#64;ContentChildren(TabComponent) tabs!: QueryList&lt;TabComponent&gt;;
  
  ngAfterContentInit() {{ '{' }}
    // Acc√©der √† tous les tabs projet√©s
    this.tabs.forEach((tab, index) => {{ '{' }}
      tab.index = index;
      tab.isActive = index === 0; // Premier tab actif
    {{ '}' }});
  {{ '}' }}
  
  selectTab(index: number) {{ '{' }}
    this.tabs.forEach((tab, i) => {{ '{' }}
      tab.isActive = i === index;
    {{ '}' }});
  {{ '}' }}
{{ '}' }}

// Usage
&lt;app-tabs&gt;
  &lt;app-tab title="Tab 1"&gt;Content 1&lt;/app-tab&gt;
  &lt;app-tab title="Tab 2"&gt;Content 2&lt;/app-tab&gt;
  &lt;app-tab title="Tab 3"&gt;Content 3&lt;/app-tab&gt;
&lt;/app-tabs&gt;</code></pre>
      </div>
    </section>

    <section class="doc-section">
      <h2>‚öôÔ∏è Options des Query Decorators</h2>
      <div class="options-box">
        <table>
          <thead>
            <tr>
              <th>Option</th>
              <th>Type</th>
              <th>Description</th>
              <th>Exemple</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>read</code></td>
              <td>Type</td>
              <td>Sp√©cifie le type √† lire de l'√©l√©ment</td>
              <td><code>&#64;ViewChild('el', {{ '{' }}read: ElementRef{{ '}' }})</code></td>
            </tr>
            <tr>
              <td><code>static</code></td>
              <td>boolean</td>
              <td>Query r√©solu avant change detection (ngOnInit vs ngAfterViewInit)</td>
              <td><code>&#64;ViewChild('el', {{ '{' }}static: true{{ '}' }})</code></td>
            </tr>
            <tr>
              <td><code>descendants</code></td>
              <td>boolean</td>
              <td>Inclure tous les descendants (pour ContentChild)</td>
              <td><code>&#64;ContentChildren(Item, {{ '{' }}descendants: true{{ '}' }})</code></td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section class="doc-section">
      <h2>üîÑ Diff√©rences View vs Content</h2>
      <div class="comparison-table">
        <table>
          <thead>
            <tr>
              <th>Aspect</th>
              <th>ViewChild/ViewChildren</th>
              <th>ContentChild/ContentChildren</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Cible</strong></td>
              <td>Template du composant</td>
              <td>Contenu projet√© (ng-content)</td>
            </tr>
            <tr>
              <td><strong>Timing</strong></td>
              <td>ngAfterViewInit / ngAfterViewChecked</td>
              <td>ngAfterContentInit / ngAfterContentChecked</td>
            </tr>
            <tr>
              <td><strong>Use Case</strong></td>
              <td>Propre template, composants enfants</td>
              <td>Contenu venant du parent</td>
            </tr>
            <tr>
              <td><strong>Visibilit√©</strong></td>
              <td>√âl√©ments d√©finis dans le template</td>
              <td>√âl√©ments pass√©s entre les balises</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section class="doc-section">
      <h2>‚úÖ Bonnes Pratiques</h2>
      <div class="best-practices">
        <div class="practice-card good">
          <h3>‚úì √Ä Faire</h3>
          <ul>
            <li>Acc√©der aux ViewChild dans ngAfterViewInit</li>
            <li>Acc√©der aux ContentChild dans ngAfterContentInit</li>
            <li>Utiliser le ! (non-null assertion) ou undefined pour le typage</li>
            <li>Pr√©f√©rer les template references (#ref) aux s√©lecteurs CSS</li>
            <li>Utiliser QueryList.changes pour d√©tecter les ajouts/suppressions</li>
            <li>Typer correctement les ElementRef: ElementRef&lt;HTMLInputElement&gt;</li>
          </ul>
        </div>

        <div class="practice-card bad">
          <h3>‚úó √Ä √âviter</h3>
          <ul>
            <li>Acc√©der aux query dans ngOnInit (undefined)</li>
            <li>Modifier le DOM directement sans ElementRef</li>
            <li>Oublier implements AfterViewInit/AfterContentInit</li>
            <li>Utiliser static: true sans raison (anti-pattern)</li>
            <li>Manipuler massivement le DOM (pr√©f√©rer Angular)</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="doc-section">
      <h2>üìö Ressources Officielles</h2>
      <div class="resources">
        <a href="https://angular.dev/api/core/ViewChild" target="_blank" class="resource-link">
          üìñ API ViewChild
        </a>
        <a href="https://angular.dev/api/core/ContentChild" target="_blank" class="resource-link">
          üì¶ API ContentChild
        </a>
        <a href="https://angular.dev/api/core/QueryList" target="_blank" class="resource-link">
          üìã API QueryList
        </a>
      </div>
    </section>

    <nav class="doc-navigation">
      <a routerLink="/documentation/fundamentals/content-projection" class="nav-btn prev">
        ‚Üê Content Projection
      </a>
      <a routerLink="/documentation" class="nav-btn next">
        Plan de Cours ‚Üí
      </a>
    </nav>
  </article>
</div>
