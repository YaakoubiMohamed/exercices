<div class="doc-container">
  <nav class="breadcrumb">
    <a routerLink="/home">üè† Accueil</a>
    <span class="separator">‚Ä∫</span>
    <a routerLink="/documentation">üìö Documentation</a>
    <span class="separator">‚Ä∫</span>
    <span class="current">Lifecycle Hooks</span>
  </nav>

  <article class="doc-content">
    <header class="doc-header">
      <h1>üîÑ Lifecycle Hooks</h1>
      <p class="doc-subtitle">Comprendre le cycle de vie des composants Angular</p>
    </header>

    <section class="doc-section">
      <h2>üìã Qu'est-ce qu'un Lifecycle Hook ?</h2>
      <div class="definition-box">
        <p>Les <strong>lifecycle hooks</strong> sont des m√©thodes sp√©ciales qui permettent de s'ins√©rer dans des moments cl√©s du cycle de vie d'un composant Angular. Ils offrent la visibilit√© sur les moments importants et la capacit√© d'agir lorsque ces moments se produisent.</p>
      </div>
    </section>

    <section class="doc-section">
      <h2>üîÑ Ordre d'Ex√©cution</h2>
      <div class="timeline">
        <div class="timeline-phase initialization">
          <h3>üì• Phase d'Initialisation</h3>
          <div class="phase-hooks">
            <div class="hook-item">
              <span class="hook-number">1</span>
              <span class="hook-name">ngOnChanges</span>
              <span class="hook-badge multiple">Multiple</span>
            </div>
            <div class="hook-item">
              <span class="hook-number">2</span>
              <span class="hook-name">ngOnInit</span>
              <span class="hook-badge once">Une fois</span>
            </div>
          </div>
        </div>

        <div class="timeline-phase change-detection">
          <h3>üîç Phase de D√©tection</h3>
          <div class="phase-hooks">
            <div class="hook-item">
              <span class="hook-number">3</span>
              <span class="hook-name">ngDoCheck</span>
              <span class="hook-badge multiple">Multiple</span>
            </div>
          </div>
        </div>

        <div class="timeline-phase content">
          <h3>üì¶ Phase du Contenu</h3>
          <div class="phase-hooks">
            <div class="hook-item">
              <span class="hook-number">4</span>
              <span class="hook-name">ngAfterContentInit</span>
              <span class="hook-badge once">Une fois</span>
            </div>
            <div class="hook-item">
              <span class="hook-number">5</span>
              <span class="hook-name">ngAfterContentChecked</span>
              <span class="hook-badge multiple">Multiple</span>
            </div>
          </div>
        </div>

        <div class="timeline-phase view">
          <h3>üëÅÔ∏è Phase de la Vue</h3>
          <div class="phase-hooks">
            <div class="hook-item">
              <span class="hook-number">6</span>
              <span class="hook-name">ngAfterViewInit</span>
              <span class="hook-badge once">Une fois</span>
            </div>
            <div class="hook-item">
              <span class="hook-number">7</span>
              <span class="hook-name">ngAfterViewChecked</span>
              <span class="hook-badge multiple">Multiple</span>
            </div>
          </div>
        </div>

        <div class="timeline-phase cleanup">
          <h3>üßπ Phase de Nettoyage</h3>
          <div class="phase-hooks">
            <div class="hook-item">
              <span class="hook-number">8</span>
              <span class="hook-name">ngOnDestroy</span>
              <span class="hook-badge once">Une fois</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="doc-section">
      <h2>üîß D√©tail des Hooks</h2>
      <div class="hooks-list">
        @for (hook of hooks; track hook.name) {
          <div class="hook-card" [ngClass]="hook.phase.toLowerCase().replace(' ', '-')">
            <div class="hook-header">
              <div class="hook-title">
                <span class="hook-order">{{ hook.order }}</span>
                <h3>{{ hook.name }}</h3>
              </div>
              <div class="hook-badges">
                <span class="phase-badge">{{ hook.phase }}</span>
                <span class="frequency-badge" [class.once]="hook.calledOnce">
                  {{ hook.calledOnce ? '1√ó' : '‚àû' }}
                </span>
              </div>
            </div>
            <p class="hook-description">{{ hook.description }}</p>
            <div class="hook-details">
              <div class="detail-item">
                <strong>‚è±Ô∏è Timing:</strong>
                <span>{{ hook.timing }}</span>
              </div>
              <div class="detail-item">
                <strong>üí° Use Case:</strong>
                <span>{{ hook.useCase }}</span>
              </div>
            </div>
          </div>
        }
      </div>
    </section>

    <section class="doc-section">
      <h2>üí° D√©monstration Interactive</h2>
      <div class="demo-box">
        <div class="demo-controls">
          <button (click)="simulateChange()" class="demo-button">Simuler un Changement</button>
          <button (click)="clearLogs()" class="demo-button secondary">Effacer les Logs</button>
        </div>
        <div class="demo-counter">
          <strong>Counter:</strong> {{ counter }}
        </div>
        <div class="logs-container">
          <h4>üìù Logs des Lifecycle Hooks:</h4>
          @if (logs.length === 0) {
            <p class="no-logs">Aucun log pour le moment. Cliquez sur les boutons pour voir les hooks en action!</p>
          } @else {
            <div class="logs-list">
              @for (log of logs; track log) {
                <div class="log-entry">{{ log }}</div>
              }
            </div>
          }
        </div>
      </div>
    </section>

    <section class="doc-section">
      <h2>üíª Exemples de Code</h2>
      <div class="code-examples">
        <div class="code-card">
          <h4>ngOnInit - Initialisation</h4>
          <pre><code>import {{ '{' }} Component, OnInit {{ '}' }} from '@angular/core';

@Component({{ '{' }}...{{ '}' }})
export class MyComponent implements OnInit {{ '{' }}
  data: any;

  ngOnInit(): void {{ '{' }}
    // Appels API
    this.loadData();
    
    // Souscriptions
    this.dataService.getData().subscribe(data => {{ '{' }}
      this.data = data;
    {{ '}' }});
  {{ '}' }}
{{ '}' }}</code></pre>
        </div>

        <div class="code-card">
          <h4>ngOnDestroy - Nettoyage</h4>
          <pre><code>import {{ '{' }} Component, OnDestroy {{ '}' }} from '@angular/core';
import {{ '{' }} Subscription {{ '}' }} from 'rxjs';

@Component({{ '{' }}...{{ '}' }})
export class MyComponent implements OnDestroy {{ '{' }}
  private subscription = new Subscription();

  ngOnDestroy(): void {{ '{' }}
    // Unsubscribe
    this.subscription.unsubscribe();
    
    // D√©tacher listeners
    window.removeEventListener('resize', this.onResize);
    
    // Cleanup
    this.cleanup();
  {{ '}' }}
{{ '}' }}</code></pre>
        </div>

        <div class="code-card">
          <h4>ngOnChanges - Changements @Input</h4>
          <pre><code>import {{ '{' }} Component, OnChanges, Input, SimpleChanges {{ '}' }} from '@angular/core';

@Component({{ '{' }}...{{ '}' }})
export class MyComponent implements OnChanges {{ '{' }}
  @Input() user: User;

  ngOnChanges(changes: SimpleChanges): void {{ '{' }}
    if (changes['user']) {{ '{' }}
      console.log('Previous:', changes['user'].previousValue);
      console.log('Current:', changes['user'].currentValue);
      this.updateUserData();
    {{ '}' }}
  {{ '}' }}
{{ '}' }}</code></pre>
        </div>

        <div class="code-card">
          <h4>ngAfterViewInit - Acc√®s √† la Vue</h4>
          <pre><code>import {{ '{' }} Component, AfterViewInit, ViewChild, ElementRef {{ '}' }} from '@angular/core';

@Component({{ '{' }}...{{ '}' }})
export class MyComponent implements AfterViewInit {{ '{' }}
  @ViewChild('myCanvas') canvas: ElementRef;

  ngAfterViewInit(): void {{ '{' }}
    // Vue compl√®tement initialis√©e
    const ctx = this.canvas.nativeElement.getContext('2d');
    this.drawChart(ctx);
  {{ '}' }}
{{ '}' }}</code></pre>
        </div>
      </div>
    </section>

    <section class="doc-section">
      <h2>‚ö° Performance et Bonnes Pratiques</h2>
      <div class="performance-grid">
        <div class="perf-card good">
          <h3>‚úì Recommandations</h3>
          <ul>
            <li><strong>ngOnInit:</strong> Utiliser pour l'initialisation au lieu du constructor</li>
            <li><strong>ngOnDestroy:</strong> TOUJOURS nettoyer les souscriptions</li>
            <li><strong>ngAfterViewInit:</strong> Manipuler le DOM uniquement ici</li>
            <li>Utiliser les interfaces pour la s√©curit√© du typage</li>
            <li>√âviter les op√©rations co√ªteuses dans les hooks fr√©quents</li>
          </ul>
        </div>

        <div class="perf-card warning">
          <h3>‚ö†Ô∏è √Ä √âviter</h3>
          <ul>
            <li><strong>ngDoCheck:</strong> √âviter les op√©rations co√ªteuses (appel√© tr√®s souvent)</li>
            <li><strong>ngAfterViewChecked:</strong> Ne pas modifier l'√©tat (cause errors)</li>
            <li>Ne pas faire d'appels API dans ngDoCheck</li>
            <li>Oublier de unsubscribe dans ngOnDestroy (memory leaks)</li>
            <li>Modifier les bindings dans AfterView hooks</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="doc-section">
      <h2>üîç Constructor vs ngOnInit</h2>
      <div class="comparison-table">
        <table>
          <thead>
            <tr>
              <th>Aspect</th>
              <th>Constructor</th>
              <th>ngOnInit</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Moment</strong></td>
              <td>Cr√©ation de l'instance</td>
              <td>Apr√®s initialisation des inputs</td>
            </tr>
            <tr>
              <td><strong>@Input disponible</strong></td>
              <td>‚ùå Non</td>
              <td>‚úÖ Oui</td>
            </tr>
            <tr>
              <td><strong>Usage recommand√©</strong></td>
              <td>Injection de d√©pendances</td>
              <td>Initialisation, appels API</td>
            </tr>
            <tr>
              <td><strong>Testabilit√©</strong></td>
              <td>Peut compliquer les tests</td>
              <td>Meilleure pour les tests</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section class="doc-section">
      <h2>üìö Ressources Officielles</h2>
      <div class="resources">
        <a href="https://angular.dev/guide/components/lifecycle" target="_blank" class="resource-link">
          üìñ Guide Lifecycle Hooks
        </a>
        <a href="https://angular.dev/api/core/OnInit" target="_blank" class="resource-link">
          üîß API Reference
        </a>
      </div>
    </section>

    <nav class="doc-navigation">
      <a routerLink="/documentation/fundamentals/pipes" class="nav-btn prev">
        ‚Üê Pipes
      </a>
      <a routerLink="/documentation/fundamentals/input-output" class="nav-btn next">
        Input/Output ‚Üí
      </a>
    </nav>
  </article>
</div>
